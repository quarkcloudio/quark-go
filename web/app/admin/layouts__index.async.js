"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[717],{52756:function($e,R,n){n.r(R);var Q=n(97857),S=n.n(Q),X=n(19632),p=n.n(X),Y=n(96695),I=n.n(Y),q=n(15009),P=n.n(q),V=n(99289),A=n.n(V),w=n(5574),E=n.n(w),v=n(67294),f=n(7837),ee=n(94740),ne=n(3321),te=n(85418),_e=n(33852),Ge=n.n(_e),ae=n(82925),re=n(53032),ue=n(94785),O=n(7058),se=n(66949),T=n(43083),b=n(91373),oe=n(87547),le=n(11247),ie=n(39711),l=n(85893),de=function(ve){var y,Ee=(0,f.useModel)("pageLoading"),fe=Ee.pageLoading,me=(0,v.useState)({}),U=E()(me,2),o=U[0],pe=U[1],he=(0,v.useState)({}),K=E()(he,2),W=K[0],C=K[1],Me=(0,f.useModel)("pageLoading"),D=Me.setPageLoading,ce=(0,f.useModel)("@@initialState"),j=ce.initialState,d=j==null?void 0:j.accountInfo,h=(0,f.useLocation)(),m=ue.Z.parse(h.search),Pe=(0,v.useState)(""),B=E()(Pe,2),Oe=B[0],k=B[1],De=(0,v.useState)([]),Z=E()(De,2),ge=Z[0],g=Z[1],ye=(0,v.useState)([""]),F=E()(ye,2),x=F[0],L=F[1],Ce=(0,v.useState)(!1),z=E()(Ce,2),je=z[0],Le=z[1],Re=(0,v.useState)([]),H=E()(Re,2),M=H[0],Se=H[1],Ie=(0,v.useState)([]),$=E()(Ie,2),Ae=$[0],Te=$[1],be=function(){var a=A()(P()().mark(function _(){var e,t,r,i;return P()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,(0,f.request)("./config.json");case 2:if(e=u.sent,t=e.api.layout,t){u.next=7;break}return C("The layout API cannot be null!"),u.abrupt("return");case 7:return D(!0),u.next=10,(0,b.U)({url:t});case 10:r=u.sent,pe(r),r.menu&&(Se(xe(r.menu)),Te(ze((0,le.Z)(r.menu)))),i=(0,T.Ah)(r.menu,h.pathname,decodeURIComponent(c)),k(i),D(!1);case 16:case"end":return u.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),Ue=function(){var a=A()(P()().mark(function _(){var e,t,r;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(e=(0,T.Ah)(o.menu,h.pathname,decodeURIComponent(c)),k(e),c){s.next=5;break}return C(null),s.abrupt("return");case 5:return t={},Object.keys(m).forEach(function(u){u!=="api"&&(t[u]=m[u])}),D(!0),s.next=10,(0,b.U)({url:c,data:t});case 10:r=s.sent,C(r),D(!1);case 13:case"end":return s.stop()}},_)}));return function(){return a.apply(this,arguments)}}(),c="";m!=null&&m.api&&(c=m.api),(0,v.useEffect)(function(){be()},[]),(0,v.useEffect)(function(){Ue()},[m.api]);var Ke=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:o.menu,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],r=I()(e),i;try{for(r.s();!(i=r.n()).done;){var s=i.value,u=s.key;if(_===u)return g(p()(new Set(t))),t.push(u),L(p()(new Set(t))),s;if(s.routes&&s.routes.length>0){t.push(u);var J=a(_,s.routes,t);if(J)return g(p()(new Set(t))),L(p()(new Set(t))),J;t.pop()}}}catch(He){r.e(He)}finally{r.f()}},We=function a(_){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];if(_.type===2)return _;if(!(!_.routes||!_.routes.length)){var t=I()(_.routes),r;try{for(t.s();!(r=t.n()).done;){var i=r.value;if(i.type===2)return i;if(i.routes&&i.routes.length>0){e.push(i.key);var s=a(i.routes[0]);if(s)return g(e),s;e.pop()}}}catch(u){t.e(u)}finally{t.f()}}},Be=function(_){var e=M.find(function(r){return r.key===_.key});if(e&&e.type!==3){if(e.type===1&&e.routes&&e.routes.length){var t=We(e);if(!t)return;L(p()(new Set([].concat(p()(x),[t.key])))),f.history.push(t.path)}else if(e.type===2){if(e.is_link===1||e.isLink===1)return window.open(e.path,"_blank"),!1;f.history.push(e.path)}}},ke=function(_){g(_)},Ze=o==null||(y=o.rightMenus)===null||y===void 0?void 0:y.map(function(a,_){return{key:_,label:(0,l.jsx)(O.Z,{body:a})}}),Fe=(0,ie.lr)(),G=E()(Fe,2),N=G[0],Je=G[1];(0,v.useEffect)(function(){if(M&&M.length>0){var a=M.find(function(_){return _.path.startsWith(h.pathname+(N.get("api")?"?api="+N.get("api"):""))});if(!a)return;Ke(a.key)}},[h,M]);var xe=function a(_){return _.reduce(function(e,t){return e.push(t),t.routes&&t.routes.length>0&&(e=e.concat(a(t.routes))),e},[])},ze=function a(_){return _.filter(function(e){return e.routes&&e.routes.length&&(e.routes=a(e.routes)),e.show})};return(0,l.jsx)(ee.ZP,{locale:ae.Z,children:(0,l.jsxs)(ne.Z,{children:[(0,l.jsxs)(f.Helmet,{children:[(0,l.jsx)("meta",{charSet:"utf-8"}),(0,l.jsx)("title",{children:Oe})]}),(o==null?void 0:o.title)&&(0,l.jsx)(re.f,S()(S()({},o),{},{loading:fe,logo:o.logo?o.logo:se,iconfontUrl:o.iconfontUrl,openKeys:ge,selectedKeys:x,menuProps:{onOpenChange:ke,onClick:Be},onCollapse:function(_){Le(_)},menuDataRender:function(){return Ae},actionsRender:function(){return[(0,l.jsx)(O.Z,{body:o.actions},"action")]},avatarProps:{src:d!=null&&d.avatar?d==null?void 0:d.avatar:(0,l.jsx)(oe.Z,{}),size:"small",title:ve.layout==="side"?je||d==null?void 0:d.nickname:d==null?void 0:d.nickname,render:function(_,e){return(0,l.jsx)(te.Z,{menu:{items:Ze},children:e})}},footerRender:function(){return(0,l.jsx)(O.Z,{body:o.footer})},children:W?(0,l.jsx)(O.Z,{body:W}):(0,l.jsx)(f.Outlet,{})}))]})})};R.default=de}}]);
